<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <title>Bootstrap demo</title>
    <link rel="stylesheet" href="dashboard.css">
    <link rel="stylesheet" href="cek_nik_user.css">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
    <script>
      // Fungsi untuk memanggil Apps Script dan mengecek NIK
      function cekNIK() {
          var nik = document.getElementById("nik").value;
          google.script.run.withSuccessHandler(fillForm).cekNIK(nik);
      }

      // Fungsi untuk mengisi form jika NIK ditemukan
      function fillForm(data) {
          if (data) {
              document.getElementById("nama").value = data.nama;
              document.getElementById("tempatLahir").value = data.tempatLahir;
              document.getElementById("tanggalLahir").value = data.tanggalLahir;
              document.getElementById("pekerjaan").value = data.pekerjaan;
              document.getElementById("alamat").value = data.alamat;
              document.getElementById("jeniskelamin").value = data.jeniskelamin;
              document.getElementById("agama").value = data.agama;
              document.getElementById("tanggalsurat").value = data.tanggalsurat;
              document.getElementById("phone").value = data.phone;
          } else {
              alert("NIK tidak ditemukan!");
          }
      }

      // Fungsi untuk menyimpan data ke spreadsheet
      function submitForm() {
          var nama = document.getElementById("nama").value;
          var nik = document.getElementById("nik").value;
          var tempatLahir = document.getElementById("tempatLahir").value;
          var tanggalLahir = document.getElementById("tanggalLahir").value;
          var pekerjaan = document.getElementById("pekerjaan").value;
          var alamat = document.getElementById("alamat").value;
          var jeniskelamin = document.getElementById("jeniskelamin").value;
          var agama = document.getElementById("agama").value;
          var tanggalsurat = document.getElementById("tanggalsurat").value;
          var phone = document.getElementById("phone").value;
          google.script.run.submitForm(nama, nik, tempatLahir, tanggalLahir, pekerjaan, alamat,jeniskelamin,agama, tanggalsurat, phone);
          alert("Terimakasih telah menginput.");
      }
  </script>

  <style>
    label {
      font-weight: bold;
      margin-top: 15px;
    }
   
    
  </style>
  </head>


  <body>
    <nav class="navbar fixed-top bg-primary" data-bs-theme="dark">
        <div class="container-fluid">
            <span class="navbar-brand mb-0 h1">Agro Kopiko Meranti</span>
            <div class="btn-group">
                <a href="dasboard.html" class="btn btn-primary">Home</a>
                <a href="cek_nik_user.html" class="btn btn-primary">Buat Surat</a>
                <a href="#" class="btn btn-primary">Laporan Keuangan</a>
                <a href="tentang.html" class="btn btn-primary">Tentang</a>
                <a href="login.html" class="btn btn-primary">Login</a>
              </div>
        </div>     
      </nav>

      <div class="row mt-5" style="display: flex;">

        <div div class="col-md-6" style="padding-left: 5%; background-color: aliceblue;">
          <br><h3 class="card-title">Jenis Surat (Keterangan Surat)</h3>

          <form onsubmit="submitForm(); return false;">
            <label for="nik">NIK:</label><br>
            <input class="col-md-4" type="text" id="nik" name="nik"><br>
            <button class="btn btn-success" style="margin-top: 1%; border:2px;" type="button" onclick="cekNIK()">Cek NIK</button><br><br>
            <h5>Cek Keterangan</h5>
    
            <label for="nama">Nama:</label><br>
            <input class="col-md-7"  type="text" id="nama" name="nama"><br>
    
            <label for="tempatLahir">Tempat Lahir:</label><br>
            <input class="col-md-7"  type="text" id="tempatLahir" name="tempatLahir"><br>
    
            <label for="tanggalLahir">Tanggal Lahir:</label><br>
            <input class="col-md-7"  type="text" id="tanggalLahir" name="tanggalLahir"><br>
    
            <label for="pekerjaan">Pekerjaan:</label><br>
            <input class="col-md-7"  type="text" id="pekerjaan" name="pekerjaan"><br>
    
            <label for="alamat">Alamat:</label><br>
            <input class="col-md-7"  type="text" id="alamat" name="alamat"><br>
    
            <label for="jeniskelamin">Jenis Kelamin:</label><br>
            <input class="col-md-7"  type="text" id="jeniskelamin" name="jeniskelamin"><br>
    
            <label for="agama">Agama:</label><br>
            <input class="col-md-7"  type="text" id="agama" name="agama"><br>
    
            <label for="tanggalsurat">Tanggal Surat:</label><br>
            <input class="col-md-7"  type="date" id="tanggalsurat" name="tanggalsurat"><br>
    
            <label for="phone">No Hp:</label><br>
            <input class="col-md-7"  type="text" id="phone" name="phone"><br>
    
            <button class="btn btn-primary" style="margin: 1%" type="submit">Submit</button>
        </form>
      </div>
      <div class="col-md-6   "   >
        <img class="img-fluid" src="1.png"  
        alt="Logo Kawasan" class="img-thumbnail" >
      </div>
    
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js" integrity="sha384-YvpcrYf0tY3lHB60NNkmXc5s9fDVZLESaAA55NDzOxhy9GkcIdslK1eN7N6jIeHz" crossorigin="anonymous"></script>
  </body>
</html>
