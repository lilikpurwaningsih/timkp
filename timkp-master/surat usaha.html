<DOCTYPE html>
    <html>
      <head>
        <base target="_top">
        <link href="https://getbootstrap.com/docs/5.3/assets/css/docs.css" rel="stylesheet">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-QWTKZyjpPEjISv5WaRU9OFeRpok6YctnYmDr5pNlyT2bRjXh0JMhjY6hW+ALEwIH" crossorigin="anonymous">
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
      </head>
       <style>
        .navbar {
            background-color: #ffffff;
            border: 1px solid #2D83B6;
            box-shadow: 2px 0 5px rgba(0, 0, 0, 0.1);
        }
        .navbar img {
            width: 190px;
            margin-left: 20px;
        }
        .navbar-nav{
          padding-right: 80px;
        }
        .navbar-nav .nav-link{
          display: flex;
            font-family: Arial, sans-serif;
            font-weight: 700;
            color: #015C93;
            border-radius: 15px;
            margin: 0 20px 0 20px;
        }
        .navbar-nav .nav-link:hover {
            background-color: #2D83B6;
            color: #ffffff;
        }
        .dropdown-menu {
            min-width: 200px;
        }
        .dropdown-item {
            text-align: center;
            font-weight: 600;
        }
        .dropdown-toggle::after {
          display: none;
        }
        .content {
            display: flex;
            flex: 1; /* Occupy all the available space */
            margin: 20px;
            justify-content: center;
        }
    
        .card {
            margin-top: 70px;
            background-color: #ffffff;
            border: 1px solid #cbcbcb;
            width: 70%;
            max-width: 100%; /* Ubah dari fixed width menjadi fleksibel */
            padding: 1rem;
            box-shadow: 2px 4px 2px rgba(0, 0, 0, 0.228);
        }
    
        .card:hover{
            transform: none;
        }
    
        .card-header{
            display: flex;
            align-items: center;
            font-size: 20px;
            color: #000000;
            background-color: #E6F2FF;
            margin: 0;
            justify-content: space-between;
        }
        .card .row{
            display: flex;
            margin-top: 5px;
            text-align: left;
        }
        .mb-3 .form-control{
            box-shadow: 0 2px 2px rgba(0, 0, 0, 0.1);
            
        }
        .mb-3 .form-label{
            margin-bottom: 2px;
            color: #000000;
            font-size: 14px;
        }
        .row1{
            display: flex;
            flex-direction: column;
        }
        .row1 input{
            width: 15em;
            border: 1px solid #cbcbcb;
            border-radius: 4px;
            box-shadow: 0 3px 2px rgba(0, 0, 0, 0.1);
            margin-bottom: 10px;
        }
        .row1 button{
            width: 6em;
        }
        
      </style>
      <body>
        <nav class="navbar fixed-top navbar-expand-lg">
          <div class="container-fluid justify-content-between">
              <a class="navbar-brand" href="#">
                  <img src="logo web.png" alt="RETE MERANTI">
              </a>
              <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarTogglerDemo02" aria-controls="navbarTogglerDemo02" aria-expanded="false" aria-label="Toggle navigation">
                  <span class="navbar-toggler-icon"></span>
              </button>
              <div class="collapse navbar-collapse" id="navbarTogglerDemo02">
                  <ul class="navbar-nav ms-auto mb-2 mb-lg-0">
                      <li class="nav-item">
                          <a class="nav-link" aria-current="page" href="#">Beranda</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link" href="#">Registrasi</a>
                      </li>
                      <li class="nav-item">
                          <a class="nav-link" href="#">Tentang Kami</a>
                      </li>
                      <li class="nav-item">
                        <a class="nav-link" href="#"  style="background-color: #2D83B6; border-radius: 15px; color: #ffffff; padding: 6px 30px;">Masuk</a>
                      </li>
                  </ul>
              </div>
          </div>
      </nav>
          
        <div class="content">
          <div class="card">
          <div class="card-header" id="cardTitle">Surat Keterangan Usaha
            
          </div>
    
            <div class="card-body">
              <form id="nikForm">
              <div class="row1"> 
                  <label for="nik" style="font-weight: 500; margin-bottom: 10px; font-size: 14px;">Masukkan NIK (Nomor Induk Kependudukan):</label>
                  <input required class="form-control form-control-md" type="text" id="nik" name="nik">
                  <button class="btn btn-primary"  type="button" onclick="checkNIK()" style="font-size: 14px;">Cek NIK</button>
              </div>
           
              <div class="row">
                <p style="text-align: left; font-style: italic; font-weight: 400; font-size: 15px; margin-top: 20px; margin-bottom: 10px;"> Pastikan data anda yang muncul sudah benar, jika benar silahkan klik tombol kirim.</p>
    
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label" for="nama">Nama:</label>
                    <input required class="form-control form-control-md" type="text" id="nama" name="nama">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="tempatLahir">Tempat Lahir:</label><br>
                    <input required class="form-control form-control-md" type="text" id="tempatLahir" name="tempatLahir">
                  </div>
                  <div class="mb-3">
                     <label class="form-label" for="tanggalLahir">Tanggal Lahir:</label><br>
                     <input required class="form-control form-control-md" type="text" id="tanggalLahir" name="tanggalLahir">
                  </div>
                  <div class="mb-3">
                     <label class="form-label" for="pekerjaan">Pekerjaan:</label><br>
                     <input required class="form-control form-control-md" type="text" id="pekerjaan" name="pekerjaan">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="alamat">Alamat:</label><br>
                    <input required class="form-control form-control-md" type="text" id="alamat" name="alamat">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="jenisKelamin">Jenis Kelamin:</label><br>
                    <input required class="form-control form-control-md" type="text" id="jenisKelamin" name="jenisKelamin">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="agama">Agama:</label><br>
                    <input required class="form-control form-control-md" type="text" id="agama" name="agama">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="statusPerkawinan">Status Perkawinan:</label><br>
                    <input required class="form-control form-control-md" type="text" id="statusPerkawinan" name="statusPerkawinan">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="tanggalPengajuan">Tanggal Pengajuan:</label><br>
                    <input required class="form-control form-control-md" type="date" id="tanggalPengajuan" name="tanggalPengajuan">
                  </div>
                  <div class="mb-3">
                    <label class="form-label" for="phone">No Hp:</label><br>
                    <input required class="form-control form-control-md" type="string" id="phone" name="phone" placeholder="contoh : 628123456789">
                  </div>
                </div>
    
                <div class="col-md-6">
                  <div class="mb-3">
                    <label class="form-label" for="nomorRumah">Silahkan Masukan Nama Usaha Anda:</label><br>
                    <input required class="form-control form-control-md" type="text" id="namaUsaha" name="namaUsaha" placeholder="contoh : KANTIN SEKOLAH di SD Negeri 32 Pontianak Tenggara" >
                  </div>
                  <div class="mb-3">
                     <label class="form-label" for="keperluanSurat"> Keperluan Surat:</label>
                     <input required class="form-control form-control-md"  type="text" id="keperluanSurat" name="keperluanSurat"placeholder="contoh : Kelengkapan Administrasi Melamar Pekerjaan" >
                  </div>
                </div>
              </div>
              <div class="text-start">
                  <a class="btn btn-secondary" href="buat surat user2.html" role="button">Batal</a>
                  <button style="border-radius: 5px;" class="btn btn-primary " type="button" onclick="submitData()">Kirim</button>
              </div>
              </form>
            </div>
          </div>
        </div>
      </div>
       
      <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-oBqDVmMz4fnFO9gybV5DAUw5vD8eUJ6zBMQpPHh8SA7Sk2zVw1ANc2x1pV8A8H4" crossorigin="anonymous"></script>
      <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.min.js" integrity="sha384-Jm00rjj5NcJddFsbncCOASVZHoPr5fx0M/mQgP0t9VmLkzD7SpdFW/Ny5ddzURyF" crossorigin="anonymous"></script>
      
        <base target="_top">
      <script>
        // Fungsi untuk memeriksa NIK dan mengisi form otomatis
        function checkNIK() {
          var nik = document.getElementById("nik").value;
          google.script.run.withSuccessHandler(function(data) {
            if (data) {
              document.getElementById("nama").value = data.nama;
              document.getElementById("tempatLahir").value = data.tempatLahir;
              document.getElementById("tanggalLahir").value = data.tanggalLahir;
              document.getElementById("pekerjaan").value = data.pekerjaan;
              document.getElementById("alamat").value = data.alamat;
              document.getElementById("jenisKelamin").value = data.jenisKelamin;
              document.getElementById("agama").value = data.agama;
              document.getElementById("statusPerkawinan").value = data.statusPerkawinan;
              document.getElementById("phone").value = data.phone;
            } else {
              alert("NIK tidak ditemukan.");
            }
          }).getDataByNIK(nik);
        }
    
        // Fungsi untuk memvalidasi form sebelum pengiriman
        function validateForm() {
          var requiredFields = [
            'nik', 'nama', 'tempatLahir', 'tanggalLahir', 'pekerjaan', 
            'alamat', 'jenisKelamin', 'agama', 'statusPerkawinan', 
            'tanggalPengajuan', 'phone', 'namaUsaha', 'keperluanSurat'
          ];
    
          for (var i = 0; i < requiredFields.length; i++) {
            var field = document.getElementById(requiredFields[i]);
            if (field && field.value.trim() === "") {
              alert('Field ' + requiredFields[i] + ' harus diisi.');
              field.focus();
              return false;
            }
          }
    
          return true;
        }
    
        // Fungsi untuk mengirim data setelah validasi
        function submitData() {
          if (!validateForm()) {
            return; // Jangan kirim jika validasi gagal
          }
    
          var data = {
            nik: document.getElementById("nik").value,
            nama: document.getElementById("nama").value,
            tempatLahir: document.getElementById("tempatLahir").value,
            tanggalLahir: document.getElementById("tanggalLahir").value,
            pekerjaan: document.getElementById("pekerjaan").value,
            alamat: document.getElementById("alamat").value,
            jenisKelamin: document.getElementById("jenisKelamin").value,
            agama: document.getElementById("agama").value,
            statusPerkawinan: document.getElementById("statusPerkawinan").value,
            tanggalPengajuan: document.getElementById("tanggalPengajuan").value,
            phone: document.getElementById("phone").value,
            namaUsaha: document.getElementById("namaUsaha").value,
            keperluanSurat: document.getElementById("keperluanSurat").value
          };
          
          google.script.run.submitData(data);
          alert("Data berhasil dikirim.");
        }
      </script>
      
      </body>
    </html>